<!DOCTYPE html>
<html>
  <head>
    <!-- built with bespoke.js -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Extending the offline web</title>
    <link rel="stylesheet" type="text/css" href="assets/fonts/stylesheet.css">
    <link rel="stylesheet" type="text/css" href="build/build.css">
    <link rel="stylesheet" type="text/css" href="assets/css/extending-offline-web.css">


    <script src="assets/javascript/fetch.js"></script>
    <script src="assets/javascript/beautify.js"></script>
    <script src="/mani/mani.js "></script>
    <script src="assets/javascript/extending-offline-web.js"></script>


  </head>
  <body>
    <article>


      <section>
        <h1>Extending the</br>offline web</h1>
      </section>

      <!--
      <section>
        <h2>How do we perceive web content:</h2>
        <h2><strong>population, decay, renewal and distance</strong></h2>
      </section>
      -->


       <section>
           <!--
        <h2 class="subdue">One of the strongest perceptions of modern mobile is the</h2>
        -->
       <h2><strong>&quot;persistence of experience&quot;</strong> for distant sources of content<!-- and human interaction-->
        </h2>
      </section>


        <section>
            <h2>https://www.washingtonpost.com/pwa/</h2>
            <div class="flex-container">
                <div class="flex-item"><img src="assets/images/washpost01.png" alt="mockup of a possible offline version the british airways website" /></div>
                <div class="flex-item"><img src="assets/images/washpost02.png" alt="mockup of a possible offline version the amazon website" /></div>
            </div>
        </section>


        <section>
            <p class="expanded"><strong>When building examples and demos, focus on how to add technologies to mature sites</strong> <span class="subdue">with 100k+ LOC,
            not how “super easy” it is to build something greenfield. We know that. Greenfield is always easy, but that’s not the
            real world. Some of this stuff can be done easily, if not elegantly, and it’s better than forking and running
                away</span></p>

        <p>Andrew Betts - https://trib.tv/2016/06/05/progressively-less-progressive/</p>
      </section>


      <section>
          <h2>The guardian jobs website</h2>
        <img src="assets/images/theguardianjobs01.png" alt="screenshot of the guardian jobs website" style="width:75%"/>
      </section>


      <section>
          <h2>Responsive layout</h2>
        <img src="assets/images/theguardianjobs02.png" alt="screenshot of the guardian jobs website at mobile screen size" style="height:75%"/>
      </section>





       <section>
          <h2>Mockup of a possible offline version</h2>
        <img src="assets/images/theguardianjobs03.png" alt="mockup of a possible offline version the guardian jobs website" style="height:75%"/>
      </section>


        <section>
            <h2>Mockups of possible offline versions</h2>
            <div class="flex-container">
                <div class="flex-item"><img src="assets/images/british-airways.png" alt="mockup of a possible offline version the british airways website" /></div>
                <div class="flex-item"><img src="assets/images/amazon.png" alt="mockup of a possible offline version the amazon website"  /></div>
            </div>
        </section>


      <section>
            <!--<h2>Progressively less progressive</h2>-->
            <p class="expanded"><span class="subdue">When building examples and demos, focus on how to add technologies to mature sites with 100k+ LOC,
            not how “super easy” it is to build something greenfield. We know that. Greenfield is always easy, but that’s not the
            real world. </span><strong>Some of this stuff can be done easily, if not elegantly, and it’s better than forking and running
                away</strong></p>

        <p>Andrew Betts - https://trib.tv/2016/06/05/progressively-less-progressive/</p>
      </section>


       <section>
          <h2>&quot;App shell&quot; terminology and concept has issues</h2>
        <img src="assets/images/appshell.jpg" alt="mockup of a possible offline version the guardian jobs website" style="height:75%"/>
      </section>


            <section>
        <img src="assets/images/jake01.png" alt="mockup of a possible offline version the guardian jobs website" style="height:75%"/>
      </section>


      <section>
          <h2>An approach that's more</br><strong>site funiture cache</strong> than <del>app-shell</del></h2>
      </section>


      <section>
        <h2>Tipping points for</br>offline UX and architecture</h2>
        <ol class="larger">
            <li>The &quot;Lie-fi&quot; gap (offline first)</li>
            <li>All content is NOT equal</br>when offlining a site</li>
            <li>Streams and notification UX patterns</li>
       </ol>
      </section>


    <section>
        <h2>1. The &quot;Lie-fi&quot; gap (offline first)</h2>
        <img src="assets/images/lie-fi-gap.png" alt="mockup of a possible offline version the guardian jobs website" style="width:75%" />
    </section>



      <section>
          <div class="flex-container">
              <div class="flex-item"><img src="assets/images/theguardianjobs03.png" alt="mockup of a possible offline version the guardian jobs website"/></div>
              <div class="flex-item">
                  <h2>2. All content is NOT equal when offlining a site</h2>
                  <ul>
                    <li>Size</li>
                    <li>Frequency of renewal</li>
                    <li>Multiple conflicting writes</li>
                    <li>Relevance to user</li>
                  </ul>
              </div>
          </div>
      </section>


    <section>
        <h2>3. Streams and notification UX patterns</h2>
        <div class="flex-container">
            <div class="flex-item"><img src="assets/images/twitter.png" alt="screenshot of the twitter website" style="width:75%" /></div>
            <div class="flex-item">
                The move to streams and notification in mobile apps can just be seen as part of the evolution of the products we design to communicate.</br></br>
                I would suggest these features are also driven by the offline properties (restrictions) of mobile devices.
            </div>
        </div>
    </section>



      <section>
          <h2>What elements of document search can be provided offline?</h2>
        <img src="assets/images/theguardianjobs01.png" alt="screenshot of the guardian jobs website" style="width:65%"/>
      </section>


        <section>
          <h1>Mani</h1>
          <p>Document based search tool in javascript</br>https://github.com/glennjones/mani</p>
      </section>


      <section>
        <img src="assets/images/friendsdont.png" alt="image of tweet: Friends don’t let friends build their own {CRYPTO, SYNC, DATABASE}." style="width:60%"/>
      </section>


      <section>
        <h2>Creating the index and loading the documents</h2>
        <pre><code class="language-javascript">var options = {
    'text': [
       {'path': 'title', 'boost': 20},
       {'path': 'text'}
    ]
}

var index = new Mani(options);

index.add({
    title: 'Application Cache: Douchebag',
    text: 'The Application Cache is one of the cool bits of HTML5...',
    tags: ['appcache','html5','web app','offline']
    ...
});</code></pre>
   </section>

         <section>
        <h2>Creating a query</h2>
        <pre><code class="language-javascript">var results = index.search({
    'text': 'promises'
})
</code></pre>
   </section>

      <section>
        <h2>Free text query</h2>
            <div class="flex-container">
                <div class="flex-item edit-panel">
                   <ul class="textarea-tabs">
                    <li><span id="text-simple">Simple</span></li>
                    <li><span id="text-paging">Paging</span></li>
                    <li><span id="text-sort">Sort</span></li>
                    </ul>
                <textarea id="input01" class="edit-area">
{
    "text": "promises"
}
                </textarea>
            </div>
            <div id="output01" class="flex-item edit-panel edit-html-result">&nbsp;</div>
        </div>


   </section>


         <section>
        <h2>Facets</h2>
            <div class="flex-container">
                <div class="flex-item edit-panel">
                                   <ul class="textarea-tabs">
                    <li><span id="facet-simple">Simple</span></li>
                    <li><span id="facet-properties">Properties</span></li>
                    <li><span id="facet-text">Text</span></li>
                    </ul>
                <textarea id="input02" class="edit-area">{
    "facets": {
        "path": "tags"
    }
}
                </textarea>
            </div>
            <div id="output02" class="flex-item edit-panel edit-html-result">&nbsp;</div>
        </div>
</section>



<section>
        <h2>Structured queries</h2>
            <div class="flex-container">
                <div class="flex-item edit-panel">
                                   <ul class="textarea-tabs">
                    <li><span id="structured-simple">Simple</span></li>
                    <li><span id="structured-op">Operators</span></li>
                    <li><span id="structured-complex">Complex</span></li>
                    </ul>
                <textarea id="input03" class="edit-area">{
    "query": {
        "sponsors":   null
    }
}       </textarea>
            </div>
            <div id="output03" class="flex-item edit-panel edit-html-result">&nbsp;</div>
        </div>
</section>


<section>
        <h2>Creating Geo Index</h2>
        <pre><code class="language-javascript">var options = {
    'text': [
        {'path': 'name', 'boost': 20},
        {'path': 'tag'}
    ],
    'geo': {
        'point': {
            'latitudePath': 'location.latitude',
            'longitudePath': 'location.longitude',
        }
    }
}
var index = new Mani(options)</code></pre>
</section>


<section>
        <h2>Geo</h2>
            <div class="flex-container">
                <div class="flex-item edit-panel">
                    <ul class="textarea-tabs">
                    <li><span id="geo-nearby">Nearby</span></li>
                    <li><span id="geo-offset">Offset</span></li>
                    <li><span id="geo-complex">Complex</span></li>
                    </ul>
                <textarea id="input04" class="edit-area">{
    "nearby": {
        "longitude": "-0.14292",
        "latitude": "50.82106"
    }
} </textarea>


            </div>
            <div id="output04" class="flex-item edit-panel edit-html-result">&nbsp;</div>
        </div>

</section>


      <section>


           <img src="assets/images/diagram.png" alt="diagram of Mani design" style="width: 100%" />

    </section>


<section>
        <h2>Serialize data and indexes to JSON</h2>
        <pre><code class="language-javascript">var index = new Mani(options);
index.add( [...] );

// To JSON
var json = JSON.stringify( index.toJSON() );

// From JSON
index.fromJSON( JSON.parse( json ));</code></pre>
</section>


<section>
        <h2>Persistent browser storage</h2>
        <pre><code class="language-javascript">var index = new Mani(options);
var persist = new Persist(index, {
        name: 'places',
        auto: true
    }, function(err, items){
    // add action such as search
});</code></pre>
</section>

      <section>
        <h2>Built on top of</h2>
        <p>This project stands on the shoulders of others:</p>

        <ul class="larger">
        <li><strong><a class="hidestyle" href="http://lunrjs.com/">lunrjs</a></strong>  - free text search<br></li>
        <li><strong><a class="hidestyle" href="https://github.com/louischatriot/nedb">nedb</a></strong>  - the query engine from nedb<br></li>
        <li><strong><a class="hidestyle" href="https://github.com/manuelbieh/Geolib">geolib</a></strong>  - nearby search</li>
        <li><strong><a class="hidestyle" href="https://github.com/mozilla/localForage">localForage</a></strong>  - data persistence<br></li>
        </ul>

      </section>



      <section>
        <h2>What's still missing from Mani?</h2>
        <ul class="larger">
            <li>Sync</li>
            <li>Real-time updates</li>
            <li>Baked in web worker support</li>
            <li>Indexdb support</li>
            <li>Promises</li>
            <li>Data typing</li>
        </ul>
      </section>


      <section>
        <h2>Maybe there is no need to reinvent the wheel - consider using:</h2>
        <ul >
            <li><strong><a class="hidestyle" href="">idb</a></strong> - Promises wrap of indexdb</li>
            <li><strong><a class="hidestyle" href="">Dixie.js</a></strong>  - Wrapper for indexdb</li>
            <li><strong><a class="hidestyle" href="">Pouchdb</a></strong>  - Universal db with sync</li>
            <li><strong><a class="hidestyle" href="">Hoodie</a></strong>  - Offline-first architecture for web apps</li>
            <li><strong><a class="hidestyle" href="">Pusher</a></strong> - Realtime messaging (SaaS)</li>
            <li><strong><a class="hidestyle" href="">Firebase</a></strong> - Realtime messaging and synced db (SaaS)</li>
        </ul>
      </section>



      <section>
        <h1>What did I learn...</h1>
      </section>


      <section>
        <h2>An asymmetrical offline experience is a valid design outcome</h2>
        <div class="flex-container">
            <div class="flex-item"><img src="assets/images/maps01.png" alt="screenshot of the googles maps andriod app" style="width:60%" /></div>
            <div class="flex-item"><img src="assets/images/maps02.png" alt="screenshot of the googles maps andriod app offline settings" style="width:60%" /></div>
            </div>
        </div>
    </section>


         <section>
        <p>You can provide document search offline</p>
        <h2>Within tight constraints you can provide free text, geo search and mix that with structured queries and facets.</h2>
      </section>


      <section>
        <p>Mani is an experiment and is NOT production code</p>
        <h2>The techniques and approaches used in Mani are practical for certain data/content profiles</h2>
      </section>

      <section>
        <h2>We need a new generation of client-side data store libraries, with the features and functional depth we can find on the server.</h2>
      </section>



        <section>
            <h1>Q&A</h1>
        </section>


        <section>
            <h2>Presented to Async.js on 23 June 2016 in Brighton. The content and code are open sourced under MIT licence.</br>Glenn Jones.</h2>
        </section>


    </article>
    <script src="build/build.js"></script>
  </body>
</html>